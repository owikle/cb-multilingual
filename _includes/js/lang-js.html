<script>
// get site language, store in localStorage, or load from localStorage
var site_language = ""; 
if (localStorage.getItem("lang")) { 
    // get the value from local store
    site_language = localStorage.getItem("lang");
} else { 
    // set default value
    site_language = "eng";
    // set value in local store
    localStorage.setItem("lang","eng");
}

// set button to checked
document.querySelector("#" + site_language).checked = true;

// show the default language
$("." + site_language).show();

// radio button selects language
$("input[name='lang_options']").change(function(){
    // hide the current language
    $("." + site_language).hide();
    // set the selected language
    site_language = this.value;
    // show the selected language
    $("." + site_language).show();
    // store the new selected language
    localStorage.setItem("lang", site_language);
});

// set selected button to checked
document.querySelector("#" + site_language).checked = true;

//document.querySelectorAll(".eng").forEach( node => node.classList.add("display-none"));

/* below is test translation span code --> not fully integrated with the switching above yet! */ 

// set up translations dictionary
var translations = { 
    {% for t in site.data.config-translation %}
    "{{ t.span_id }}": { 
        {% for l in site.site_languages %}
        "{{ l.lang_id }}": "{{ t[l.lang_id] }}"{% unless forloop.last %},{% endunless %}{% endfor %}
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
}
// function to set all translated spans
function fillTranslationSpans () {
    // find all translate spans
    document.querySelectorAll(".translate").forEach( node => {
        // find text for site language
        // there needs to be a bunch of ifs to ensure there is a fall back!
        let span_text = translations[node.id][site_language];
        // add to the span element
        node.innerHTML = span_text;
    });
}
// run function after load
fillTranslationSpans();


</script>